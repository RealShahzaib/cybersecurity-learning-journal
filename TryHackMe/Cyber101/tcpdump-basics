ğŸ§ Tcpdump Basics â€” TryHackMe Writeup
ğŸ“– Introduction: What is Tcpdump and Why Do We Use It?
While studying networking and protocols, we usually learn everything in theory but rarely get to actually see how protocol conversations take place in real time. After using internet services for years, we still donâ€™t visually understand what is happening behind the scenes when packets are being sent and received.

That is why one of the best practices in cybersecurity and networking is to capture and analyze network traffic, as it helps us truly understand how networks function.

Tcpdump is a command-line packet analysis tool that allows us to:

Capture live network packets

Apply filters to specific traffic

Save packets into files (PCAP)

Analyze network behavior at a deeper level

It is similar in purpose to Wireshark, but instead of a GUI, tcpdump works entirely through the command line, which makes it very useful in servers and real-world SOC environments.

ğŸ› ï¸ Learning the Basics of Tcpdump Usage
The first thing I learned was how tcpdump listens on network interfaces. For example, we can capture traffic from a specific interface or all interfaces:

Bash
# Capture from a specific interface
tcpdump -i eth0

# Listen on all available interfaces
tcpdump -i any
To check the available interfaces on the system, I used ip a. This helped me understand common interfaces like:

eth0 â†’ Wired Ethernet

wlan0 â†’ Wireless network interface

ğŸ’¾ Capturing and Saving Packets (PCAP Files)
One very important feature of tcpdump is the ability to save captured traffic into files for later analysis.

Bash
tcpdump -w packetlog.pcap
I learned that packets can be stored in .pcap format, which is commonly used in network forensics. I also explored the difference between formats:

PCAP: Traditional packet capture format.

PCAPNG: Modern format with better precision, metadata, and multi-interface support.

To read packets from a saved capture file:

Bash
tcpdump -r traffic.pcap
ğŸ¯ Packet Control and Performance Options
To prevent tcpdump from capturing indefinitely, we can limit the count:

Bash
# Limit to 50 packets
tcpdump -c 50
Optimization & Verbosity
By default, tcpdump tries to resolve IP addresses into domain names (DNS), which can slow down analysis. We can disable this:

-n : Disable name resolution.

-nn : Disable both hostname and port resolution.

-v or -vv : Increase the level of detail (Verbosity).

ğŸ” Filtering Traffic in Tcpdump
Filtering is one of the most powerful aspects of tcpdump.

ğŸ“¡ Host-Based Filtering
To isolate traffic related to a specific IP:

Bash
tcpdump host <IP>
tcpdump src host <IP> # Only source
tcpdump dst host <IP> # Only destination
ğŸ”Œ Port-Based Filtering
Useful for analyzing specific services, like DNS:

Bash
tcpdump port 53
ğŸŒ Protocol-Based Filtering
Bash
tcpdump icmp
tcpdump udp
tcpdump ip
ğŸ§  Advanced Filtering and Header Analysis
I learned to filter packets using header byte inspection through pcap-filter syntax: proto[expr:size]

proto: protocol (tcp, arp, ether, etc.)

expr: byte offset

size: number of bytes to inspect

Example: ether[0] & 1 != 0 (inspects the first byte of the Ethernet header).

ğŸš© TCP Flags Filtering
I learned how to detect specific TCP behaviors by filtering for flags like SYN, ACK, FIN, and RST.

Bash
# Capturing only SYN packets
tcpdump "tcp[tcpflags] == tcp-syn"

# Capturing packets where the SYN flag is set
tcpdump "tcp[tcpflags] & tcp-syn != 0"
ğŸ–¥ï¸ Output Customization
-q : Quick/Quiet output.

-A : Display packet data in ASCII (readable text).

-e : Show link-layer headers (reveals MAC addresses).

ğŸ“ Key Takeaways
Tcpdump is a essential CLI tool for SOC analysts.

Filtering by host, port, and flags allows for precise investigations.

Understanding MAC addresses (via -e) helps identify physical devices even if IPs are spoofed.

PCAP analysis is the foundation of network forensics.
