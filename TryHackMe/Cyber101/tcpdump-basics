**#ğŸ§ Tcpdump Basics â€” TryHackMe Writeup**


#ğŸ“– Introduction: What is Tcpdump and Why Do We Use It?
While studying networking and protocols, we usually learn everything in theory but rarely get to actually see how protocolconversations take place in real time.
After using internet services for years, we still donâ€™t visually understand what is happening behind the scenes when packets are being sent and received.

That is why one of the best practices in cybersecurity and networking is to capture and analyze network traffic, as it helps us truly understand how networks function.

Tcpdump is a command-line packet analysis tool (developed in the late 1980sâ€“early 1990s) that allows us to:
Capture live network packets
Apply filters to specific traffic
Save packets into files (PCAP)
Analyze network behavior at a deeper level

It is similar in purpose to Wireshark, but instead of a GUI, tcpdump works entirely through the command line, which makes it very useful in servers and real-world SOC environments.

#ğŸ› ï¸ Learning the Basics of Tcpdump Usage
The first thing I learned was how tcpdump listens on network interfaces.

For example, we can capture traffic from a specific interface using:
tcpdump -i eth0

Or we can listen on all available interfaces using:
tcpdump -i any

To check the available interfaces on the system, I used:
ip a

This helped me understand common interfaces like:
eth0 â†’ Wired Ethernet
wlan0 â†’ Wireless network interface

#ğŸ’¾ Capturing and Saving Packets (PCAP Files)
One very important feature of tcpdump is the ability to save captured traffic into files for later analysis.

Using:
tcpdump -w packetlog.pcap

I learned that packets can be stored in .pcap format, which is commonly used in network forensics and SOC investigations.

Interestingly, I also explored the difference between PCAP and PCAPNG:
PCAP â†’ Traditional packet capture format
PCAPNG â†’ Modern format with better precision, metadata, and multi-interface support

To read packets from a saved capture file:
tcpdump -r traffic.pcap

This is especially useful when analyzing suspicious traffic offline.

#ğŸ¯ Packet Control and Performance Options
I discovered that if tcpdump is run without limits, it continues capturing packets indefinitely until manually stopped.
To control this, we can limit the number of captured packets:
tcpdump -c 50

Another useful concept was DNS resolution. By default, tcpdump tries to resolve IP addresses into domain names, which can slow down analysis.

To disable name resolution:
tcpdump -n

And to disable both hostname and port resolution:
tcpdump -nn

I also learned about verbosity levels:
-v â†’ Verbose output
-vv â†’ More detailed packet information

#ğŸ” Filtering Traffic in Tcpdump
Filtering is one of the most powerful aspects of tcpdump.

#ğŸ“¡ Host-Based Filtering

To capture traffic from or to a specific host:
tcpdump host <IP>

For source-specific traffic:
tcpdump src host <IP>

For destination-specific traffic:
tcpdump dst host <IP>

Also, I learned that packet capturing usually requires root privileges, so using sudo is necessary in most cases.

#ğŸ”Œ Port-Based Filtering
Tcpdump allows filtering by ports, which is useful for analyzing specific services.

For example, capturing DNS traffic:
tcpdump port 53

Since DNS commonly uses port 53 (UDP/TCP), this helps isolate relevant traffic quickly.

#ğŸŒ Protocol-Based Filtering
Another useful filtering method is by protocol:

tcpdump icmp
tcpdump udp
tcpdump ip

During the practical task, I analyzed a traffic.pcap file and used filters to:
Count ICMP packets
Identify ARP-related queries
Detect DNS subdomain requests
This gave me hands-on experience in real packet investigation scenarios.

#ğŸ§  Advanced Filtering and Header Analysis
One of the deeper concepts I learned was filtering packets using header byte inspection through pcap-filter syntax:
proto[expr:size]

Where:
proto = protocol (tcp, arp, ether, etc.)
expr = byte offset
size = number of bytes to inspect

For example:
ether[0] & 1 != 0

This inspects the first byte of the Ethernet header and performs a logical check.
At this point, I realized that tcpdump goes much deeper than basic packet viewing and allows very fine-grained packet analysis.

#ğŸš© TCP Flags Filtering (Advanced Concept)
I also learned about filtering packets based on TCP flags such as:
SYN
ACK
FIN
RST

Example: Capturing only SYN packets:

tcpdump "tcp[tcpflags] == tcp-syn"
Or capturing packets where the SYN flag is set:
tcpdump "tcp[tcpflags] & tcp-syn != 0"
Through tasks, I analyzed packets to:
Identify reset flag packets
Detect hosts sending unusually large packet volumes
This directly relates to detecting suspicious network behavior in cybersecurity monitoring.

#ğŸ–¥ï¸ Output Customization and Packet Display
Tcpdump also provides several options to customize how packet data is displayed:

-q â†’ Quick output
-A â†’ Display packet data in ASCII
-e â†’ Show link-layer headers (including MAC addresses)

The -e option was particularly interesting because it reveals MAC addresses.
Since IP addresses can be spoofed, checking MAC addresses can help identify the actual physical device causing unusual traffic within a network.

#ğŸ“ Key Takeaways
Tcpdump is a powerful CLI-based packet analysis tool widely used in cybersecurity and SOC environments.
It helps visualize real network traffic instead of just learning protocols theoretically.
Filtering by host, port, protocol, and TCP flags allows precise traffic investigation.
PCAP file analysis is an essential skill for real-world security analysis.
Understanding tcpdump significantly improves practical knowledge of how networks behave behind the scenes.
Overall, this room strengthened my understanding of packet capture, traffic filtering, and real-world network analysis, which are essential skills for a future SOC analyst
